import data_from_emails

def test_remove_duplicates():
    rows = [
        ["Atlanta GA", "4/1/2022", "12:00 PM", "Kevin", "0", "7", "17", "3", "0", "167", "160", "161", "162", "169", "0.18", "20:37", "0.61", "0.47", "157", "170", "20:22", "21:28", "2.54"],
        ["Atlanta GA", "4/2/2022", "10:00 AM", "Kevin", "0", "13", "25", "0", "8", "169", "163", "160", "149", "155", "1.88", "23:46", "1.51", "0.26", "152", "165", "20:33", "18:07", "1.91"],
        ["Atlanta GA", "4/3/2022", "7:15 PM", "Jacob", "0", "17", "25", "14", "1", "165", "157", "162", "168", "161", "1.62", "24:37", "2.98", "2.16", "168", "163", "23:32", "18:26", "2.31"],
        ["Atlanta GA", "4/3/2022", "7:15 PM", "Jacob", "0", "17", "25", "14", "1", "165", "157", "162", "168", "161", "1.62", "24:37", "2.98", "2.16", "168", "163", "23:32", "18:26", "2.31"],
        ["Atlanta GA", "4/4/2022", "12:00 PM", "Kevin", "3", "19", "18", "7", "8", "168", "153", "153", "167", "155", "0.53", "20:40", "1.53", "2.42", "171", "158", "17:32", "20:11", "1.11"],
        ["Atlanta GA", "4/1/2022", "12:00 PM", "Kevin", "0", "7", "17", "3", "0", "167", "160", "161", "162", "169", "0.18", "20:37", "0.61", "0.47", "157", "170", "20:22", "21:28", "2.54"],
    ]
    expected = [
        ["Atlanta GA", "4/1/2022", "12:00 PM", "Kevin", "0", "7", "17", "3", "0", "167", "160", "161", "162", "169", "0.18", "20:37", "0.61", "0.47", "157", "170", "20:22", "21:28", "2.54"],
        ["Atlanta GA", "4/2/2022", "10:00 AM", "Kevin", "0", "13", "25", "0", "8", "169", "163", "160", "149", "155", "1.88", "23:46", "1.51", "0.26", "152", "165", "20:33", "18:07", "1.91"],
        ["Atlanta GA", "4/3/2022", "7:15 PM", "Jacob", "0", "17", "25", "14", "1", "165", "157", "162", "168", "161", "1.62", "24:37", "2.98", "2.16", "168", "163", "23:32", "18:26", "2.31"],
        ["Atlanta GA", "4/4/2022", "12:00 PM", "Kevin", "3", "19", "18", "7", "8", "168", "153", "153", "167", "155", "0.53", "20:40", "1.53", "2.42", "171", "158", "17:32", "20:11", "1.11"],
    ]
    data_from_emails.remove_duplicates(rows)
    if rows == expected:
        return True
    else:
        return False

def test_sort_rows():
    rows = [
        ["Atlanta GA", "4/2/2022", "10:00 AM", "Kevin", "0", "13", "25", "0", "8", "169", "163", "160", "149", "155", "1.88", "23:46", "1.51", "0.26", "152", "165", "20:33", "18:07", "1.91"],
        ["Atlanta GA", "4/4/2022", "12:00 PM", "Kevin", "3", "19", "18", "7", "8", "168", "153", "153", "167", "155", "0.53", "20:40", "1.53", "2.42", "171", "158", "17:32", "20:11", "1.11"],
        ["Atlanta GA", "4/3/2022", "7:15 PM", "Jacob", "0", "17", "25", "14", "1", "165", "157", "162", "168", "161", "1.62", "24:37", "2.98", "2.16", "168", "163", "23:32", "18:26", "2.31"],
        ["Atlanta GA", "4/1/2022", "12:00 PM", "Kevin", "0", "7", "17", "3", "0", "167", "160", "161", "162", "169", "0.18", "20:37", "0.61", "0.47", "157", "170", "20:22", "21:28", "2.54"],
    ]
    expected = [
        ["Atlanta GA", "4/1/2022", "12:00 PM", "Kevin", "0", "7", "17", "3", "0", "167", "160", "161", "162", "169", "0.18", "20:37", "0.61", "0.47", "157", "170", "20:22", "21:28", "2.54"],
        ["Atlanta GA", "4/2/2022", "10:00 AM", "Kevin", "0", "13", "25", "0", "8", "169", "163", "160", "149", "155", "1.88", "23:46", "1.51", "0.26", "152", "165", "20:33", "18:07", "1.91"],
        ["Atlanta GA", "4/3/2022", "7:15 PM", "Jacob", "0", "17", "25", "14", "1", "165", "157", "162", "168", "161", "1.62", "24:37", "2.98", "2.16", "168", "163", "23:32", "18:26", "2.31"],
        ["Atlanta GA", "4/4/2022", "12:00 PM", "Kevin", "3", "19", "18", "7", "8", "168", "153", "153", "167", "155", "0.53", "20:40", "1.53", "2.42", "171", "158", "17:32", "20:11", "1.11"],
    ]
    data_from_emails.sort_rows(rows)
    if rows == expected:
        return True
    else:
        return False

def test_remove_errors():
    rows = [
        ["Atlanta GA", "4/1/2022", "12:00 PM", "Kevin", "0", "7", "17", "3", "0", "167", "160", "161", "162", "169", "0.18", "20:37", "0.61", "0.47", "157", "170", "20:22", "21:28", "2.54"],
        ["Atlanta GA", "4/2/2022", "error1", "Kevin", "0", "13", "25", "0", "8", "169", "163", "160", "149", "155", "1.88", "23:46", "1.51", "0.26", "152", "165", "20:33", "18:07", "1.91"],
        ["Atlanta GA", "4/3/2022", "7:15 PM", "Jacob", "0", "17", "25", "14", "1", "165", "157", "162", "168", "161", "1.62", "24:37", "2.98", "2.16", "168", "163", "23:32", "18:26", "2.31"],
        ["Atlanta GA", "4/4/2022", "12:00 PM", "Kevin", "error2", "19", "18", "7", "8", "168", "153", "153", "167", "155", "0.53", "20:40", "1.53", "2.42", "171", "158", "17:32", "20:11", "1.11"],
    ]
    expected_rows = [
    ["Atlanta GA", "4/1/2022", "12:00 PM", "Kevin", "0", "7", "17", "3", "0", "167", "160", "161", "162", "169", "0.18", "20:37", "0.61", "0.47", "157", "170", "20:22", "21:28", "2.54"],
    ["Atlanta GA", "4/3/2022", "7:15 PM", "Jacob", "0", "17", "25", "14", "1", "165", "157", "162", "168", "161", "1.62", "24:37", "2.98", "2.16", "168", "163", "23:32", "18:26", "2.31"],
    ]
    expected_errors = {
        1: (
            ["Atlanta GA", "4/2/2022", "error1", "Kevin", "0", "13", "25", "0", "8", "169", "163", "160", "149", "155", "1.88", "23:46", "1.51", "0.26", "152", "165", "20:33", "18:07", "1.91"],
            [(2, "error1")],
        ),
        3: (
            ["Atlanta GA", "4/4/2022", "12:00 PM", "Kevin", "error2", "19", "18", "7", "8", "168", "153", "153", "167", "155", "0.53", "20:40", "1.53", "2.42", "171", "158", "17:32", "20:11", "1.11"],
            [(4, "error2")],
        ),
    }
    received_errors = data_from_emails.remove_errors(rows)
    if rows == expected_rows and received_errors == expected_errors:
        return True
    else:
        print(rows)
        print(received_errors)
        return False

if __name__ == "__main__":
    all_passed = True
    remove_duplicates_passed = test_remove_duplicates()
    all_passed = all_passed and remove_duplicates_passed
    sort_rows_passed = test_sort_rows()
    all_passed = all_passed and sort_rows_passed
    remove_errors_passed = test_remove_errors()
    all_passed = all_passed and remove_errors_passed
    print("Testing remove_duplicates: " + ("Passed" if remove_duplicates_passed else "Failed"))
    print("Testing sort_rows: " + ("Passed" if sort_rows_passed else "Failed"))
    print("Testing remove_errors: " + ("Passed" if remove_errors_passed else "Failed"))
    if (all_passed):
        print("Passed all tests")
    else:
        print("Did not pass all tests")
